<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Exercises</h1>
        <div ng-drop="true" ng-drop-success="onDropComplete($data)">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            Delete exercise (drag & drop)!
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12" role="alert">
        <ol class="breadcrumb">
            <li class="active">
                <i class="fa fa-dashboard"></i> Exercices
            </li>
        </ol>
        <div class="alert alert-danger fade in" ng-show="error != null">
            <a href="" class="close" data-dismiss="alert">&times;</a>
            <strong>Error!</strong> <span style="margin-left: 50px">{{error}}</span>
        </div>
        <div class="alert alert-success fade in" ng-show="message != null">
            <a href="" class="close" data-dismiss="alert">&times;</a>
            <strong>Success!</strong> <span style="margin-left: 50px">{{message}}</span>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-sm-6 col-md-4 col-lg-3" ng-repeat="exercise in exercises" ng-click="select($index)">
        <div class="tile blue" ng-drag="true" ng-drag-data="exercise" >
            <div>
                <div class="title">
                    <h3>{{exercise.title}}</h3>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="row" ng-show="selected">
        <form id="exerciseForm" class="col-lg-12" ng-submit="processForm()">
            <div class="form-group">
                <label>Title</label>
                <input type="text" class="form-control" name="title" placeholder="Titel" ng-model="selected.title">
            </div>
            <div class="form-group">
                <label>Classification</label>
                <input type="text" class="form-control" name="classification" placeholder="Classification" ng-model="selected.classification">
            </div>
            <div class="form-group">
                <label>Class</label>
                <input type="text" class="form-control" name="class" placeholder="Class" ng-model="selected.class">
            </div>
            <div class="form-group">
                <label>Deadline</label>
                <input type="date" class="form-control" name="deadline" ng-model="selected.deadline">
            </div>
            <div class="checkbox">
                <label class="checkbox"><input type="checkbox" name="extra" ng-model="selected.extra">Extra</label>
            </div>

            <div class="panel panel-primary" style="margin-top: 40px;">
                <div class="panel-heading">
                    <h4 class="panel-title">Questions</h4>
                </div>
                <div class="table-responsive" ng-repeat="question in selected.questions"  ng-init="questionIndex = $index">
                    <table class="table">
                        <caption>
                            <div class="clearfix" style="margin-top: 10px; margin-bottom: 10px; padding-left: 8px; padding-right: 8px">
                                <span style="font-size: 20px; padding-top: 7px;" class="pull-left">Question {{$index + 1}}</span>
                                <div class="btn-group pull-right">
                                    <a class="btn btn-default btn-sm" ng-click="removeButton($index)"><span class="glyphicon glyphicon-minus"></span></a>
                                </div>
                            </div>
                        </caption>

                        <tr>
                            <td colspan="3">
                                <input type="text" class="form-control" placeholder="Title" ng-model="question.questiontitle" />
                            </td>
                        </tr>
                        <tr>
                            <td><input class="form-control" ng-model="question.weight" placeholder="Weight" type="number" /></td>
                            <td>
                                <select class="form-control" ng-model="question.type" ng-change="typeChanged($index)">
                                    <option value="" disabled selected hidden>Select the type</option>
                                    <option value="Checkbox">Checkbox</option>
                                    <option value="Question">Question</option>
                                    <option value="Code">Code</option>
                                    <option value="MultipleChoice">MultipleChoice</option>
                                </select>
                            </td>
                            <td>
                                <label class="checkbox-inline big-checkbox">
                                    <input type="checkbox" ng-model="question.extra">Extra
                                </label>
                            </td>
                        </tr>
                        <tr ng-if="question.type == 'MultipleChoice'">
                            <td colspan="3">
                                <div class="col-md-4" style="margin-bottom: 10px" ng-repeat="choice in question.choices track by $index">
                                    <input ng-if="$index == 0" class="form-control" ng-model="choice.text" placeholder="Choice {{$index + 1}}" type="text" />
                                    <div ng-if="$index > 0" class="input-group" style="width: 100%">
                                        <input class="form-control" ng-model="choice.text" placeholder="Choice {{$index + 1}}" type="text" />
                                        <div class="input-group-addon"><span class="glyphicon glyphicon-remove-circle" ng-click="removeChoice(questionIndex, $index)"></span></div>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <a class="btn btn-default btn-sm form-control" ng-click="addChoice($index)"><span class="glyphicon glyphicon-plus"></span></a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>

                <button type="button" ng-click="addButton()" class="btn btn-primary" style="margin: 20px 10px 10px 10px">Add question</button>

            </div>

            <div class="form-group top-30">
                <button type="submit" class="btn btn-default">Save</button>
            </div>

            <div>
                {{selected}}
            </div>
        </form>
</div>